{% extends 'base.html' %}

{% block title %}
homepage
{% endblock %}

{% block content %}

{% set cDate = namespace(value = '') %}
{% set cWeekDays = namespace(value = 'sunmontuewedthufrisat') %}

<table>
    <!--
    <tr>
        <td><b>date & time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td><b>name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td><b>course&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td><b>part&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td><b>instructor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
    </tr>
    -->

    {% for events in appointments %}

        {% if (events [1] == lRBAC [2]) or ('staff' in lRBAC [1]) %}

        {% set cWeekDays = "sunday   monday   tuesday  wednesdaythursday friday   saturday" %}
        {% set nWeekDay  = events[6].strftime("%w")|int * 9 %}
        {% set nWeekDay2  = nWeekDay|int + 9|int %}

        {% if (cDate.value|string() != events[6].strftime("%d-%m-%Y")|string() ) %}
            <tr><td>&nbsp;</td></tr>
            <tr><td><h5>{{ events[6].strftime("%d-%m-%Y") }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h5></td><td><h5>{{ cWeekDays[nWeekDay:nWeekDay2] }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h5></td></tr>
            {% set cDate.value = events[6].strftime("%d-%m-%Y") %}
        {% endif %}

        <tr>
            <td>{{ events[6].strftime("%H:%M:%S") }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
            <td>{{ events[2] + ' ' + events[3] }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
            <td>{{ events[4] }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
            <td>{{ events[5] }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
            <td>{{ events[7] }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
            <td>

            {% if (('staff' in lRBAC [1]) and (events [6] >= lRBAC [4] )) or ('admin' in lRBAC [1]) %}
                <a href="{{ url_for('appointmentsedit',   id = events [0] ) }} ">e</a>
                <a href="{{ url_for('appointmentsdelete', id = events [0] ) }} ">d</a> 
                {% if events [8] == 1 %}
                <a href="{{ url_for('appointmentsassign', id = events [0] ) }} ">m</a>
                {% endif %}
            {% endif %}
            </td>
        </tr>
        {% endif %}
    {% endfor %}
</table>

{% endblock %}

